<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOCIOL496</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SOCIOL496_files/libs/clipboard/clipboard.min.js"></script>
<script src="SOCIOL496_files/libs/quarto-html/quarto.js"></script>
<script src="SOCIOL496_files/libs/quarto-html/popper.min.js"></script>
<script src="SOCIOL496_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SOCIOL496_files/libs/quarto-html/anchor.min.js"></script>
<link href="SOCIOL496_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SOCIOL496_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SOCIOL496_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SOCIOL496_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SOCIOL496_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SOCIOL496</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lme4' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlmhelpr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggrepel' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'maps' was built under R version 4.3.1</code></pre>
</div>
</div>
<p>#import datasets &amp; recoding</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Level1Data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/Desktop/SOCIOL496/data/SOCIOL_Level1Data.xlsx"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Level2Data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/Desktop/SOCIOL496/data/SOCIOL_MasterData.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Master <span class="ot">&lt;-</span>  </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Level1Data, Level2Data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country_Abbrev"</span>, <span class="st">"Country_Code"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Master <span class="ot">&lt;-</span> Master <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(CTL))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>Master <span class="ot">&lt;-</span> Master <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Religion_Original =</span> religion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gender is a binary coded where 0 is male and 1 is female </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># religion is a five level categorical with none as reference group, and Christian, Muslim, Buddhist, and Other (Hindus n = 487 and Jews n = 198 ere in Others because they were relatively a small group)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># income is a 10 point Likert scale continuous variable (1-10)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># education is a three point Likert sclae 0-2</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Master <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Religion =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    Religion_Original <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    Religion_Original <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Christian"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    Religion_Original <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Muslim"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    Religion_Original <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Buddhist"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    Religion_Original  <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>) <span class="sc">~</span>  <span class="st">"Other"</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>))<span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Religion_Original)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Religion <span class="ot">&lt;-</span> <span class="fu">factor</span>(Clean<span class="sc">$</span>Religion, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"None"</span>, <span class="st">"Christian"</span>, <span class="st">"Muslim"</span>, <span class="st">"Buddhist"</span>, <span class="st">"Other"</span>))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"0"</span>, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>))<span class="sc">|&gt;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sex)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">ifelse</span>(income_EVS <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> income_WVS <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">pmax</span>(income_EVS, income_WVS), <span class="cn">NA_real_</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>income_EVS, <span class="sc">-</span>income_WVS)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Education =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    Education_recoded <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"0"</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    Education_recoded <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    Education_recoded <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>))<span class="sc">|&gt;</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Education_recoded)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Education <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Clean<span class="sc">$</span>Education)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">recode</span>(Clean<span class="sc">$</span>Country, <span class="st">"'United States' = 'USA'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CP_Support =</span> <span class="fu">if_else</span>(CP <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, CP, <span class="cn">NA_integer_</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>CP)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Political_Belief =</span> <span class="fu">if_else</span>(political_belief <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, political_belief, <span class="cn">NA_integer_</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>political_belief)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(Political_Authoritarianism = if_else(`Political Authoritarianism` %in% c(1, 0),`Political Authoritarianism`, NA_character_)) |&gt; </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Political Authoritarianism</span><span class="st">`</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>CTL_zscored)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>Clean <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>CTL_centered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>uniqid <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Clean<span class="sc">$</span>uniqid)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Country_Code <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Clean<span class="sc">$</span>Country_Code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>zero_countries_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Clean) <span class="co">#save the full dataset with 60286 observations &amp; 20 variables </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#descriptive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#83818, FINAL SAMPLE SIZE </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Clean_main <span class="ot">&lt;-</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  Clean[<span class="fu">complete.cases</span>(Clean<span class="sc">$</span>Gender, Clean<span class="sc">$</span>CP_Support), ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Clean_main<span class="sc">$</span>CP_Support, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#3.946608</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.946455</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(Clean_main<span class="sc">$</span>CP_Support, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#3.109806</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.109784</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Clean_main<span class="sc">$</span>CP_Support)) <span class="co">#83889</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 83818</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Clean_main<span class="sc">$</span>CTL) <span class="co">#1.880623</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.883578</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(Clean_main<span class="sc">$</span>CTL) <span class="co">#0.2349638</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2353724</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Clean_main <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 2
   Country   count
   &lt;chr&gt;     &lt;int&gt;
 1 Argentina   962
 2 Armenia    2695
 3 Australia  1774
 4 Austria    1588
 5 Bosnia     1662
 6 Brazil     1677
 7 Canada     4018
 8 Chile       971
 9 China      3023
10 Colombia   1520
# ℹ 34 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Clean_main <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Rowwise: 
  Gender     n
  &lt;chr&gt;  &lt;int&gt;
1 0      38630
2 1      45188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Clean_main <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country, Gender) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 3
# Groups:   Country [44]
   Country   Gender count
   &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;
 1 Argentina 0        464
 2 Argentina 1        498
 3 Armenia   0       1055
 4 Armenia   1       1640
 5 Australia 0        698
 6 Australia 1       1076
 7 Austria   0        720
 8 Austria   1        868
 9 Bosnia    0        724
10 Bosnia    1        938
# ℹ 78 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Clean_main <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country, Gender) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">|&gt;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Gender, proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 3
# Groups:   Country [44]
   Country   Gender proportion
   &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
 1 Argentina 0           0.482
 2 Argentina 1           0.518
 3 Armenia   0           0.391
 4 Armenia   1           0.609
 5 Australia 0           0.393
 6 Australia 1           0.607
 7 Austria   0           0.453
 8 Austria   1           0.547
 9 Bosnia    0           0.436
10 Bosnia    1           0.564
# ℹ 78 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># political belief</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(zero_countries_data<span class="sc">$</span>Political_Belief, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.542597</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(zero_countries_data<span class="sc">$</span>Political_Belief, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.297895</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#education </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>zero_countries_data <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
# Rowwise: 
  Education     n
      &lt;dbl&gt; &lt;int&gt;
1         0 14334
2         1 24291
3         2 21661</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#religion</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>zero_countries_data <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Religion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
# Rowwise: 
  Religion      n
  &lt;fct&gt;     &lt;int&gt;
1 None      19673
2 Christian 29674
3 Muslim     7167
4 Buddhist   2190
5 Other      1582</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gender index</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(zero_countries_data<span class="sc">$</span>Gender_Index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7239844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(zero_countries_data<span class="sc">$</span>Gender_Index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05093511</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Clean <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(CP_Support, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 2
   Country    mean
   &lt;chr&gt;     &lt;dbl&gt;
 1 Argentina  3.38
 2 Armenia    2.32
 3 Australia  4.45
 4 Austria    2.31
 5 Bosnia     3.29
 6 Brazil     4.13
 7 Canada     4.84
 8 Chile      4.25
 9 China      5.52
10 Colombia   3.96
# ℹ 34 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a> Clean <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country, Gender) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_CP_Support =</span> <span class="fu">mean</span>(CP_Support, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 3
# Groups:   Country [44]
   Country   Gender mean_CP_Support
   &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt;
 1 Argentina 0                 3.57
 2 Argentina 1                 3.21
 3 Armenia   0                 2.58
 4 Armenia   1                 2.15
 5 Australia 0                 4.78
 6 Australia 1                 4.25
 7 Australia &lt;NA&gt;              3.22
 8 Austria   0                 2.40
 9 Austria   1                 2.23
10 Bosnia    0                 3.54
# ℹ 86 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a> result <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Gender)) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country, Gender) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_CP_Support =</span> <span class="fu">mean</span>(CP_Support, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_male =</span> <span class="fu">mean</span>(mean_CP_Support[Gender <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_female =</span> <span class="fu">mean</span>(mean_CP_Support[Gender <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> mean_male <span class="sc">-</span> mean_female</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(result, diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
   Country  mean_male mean_female     diff
   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
 1 Peru          3.84        4.08 -0.239  
 2 Chile         4.16        4.33 -0.173  
 3 Kenya         3.57        3.72 -0.143  
 4 Vietnam       4.12        4.22 -0.104  
 5 Thailand      4.46        4.53 -0.0661 
 6 Latvia        3.46        3.47 -0.00127
 7 Colombia      3.97        3.96  0.00921
 8 Iran          6.92        6.80  0.122  
 9 Turkey        3.36        3.23  0.123  
10 Spain         3.70        3.57  0.134  
# ℹ 34 more rows</code></pre>
</div>
</div>
<section id="aggregated-visualizatin" class="level1">
<h1>aggregated visualizatin</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mean_diff_data <span class="ot">&lt;-</span> Clean <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_diff_CP_Support =</span> <span class="fu">mean</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">mean</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_diff_CP_Support =</span> <span class="fu">sqrt</span>((<span class="fu">sd</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">0</span>]))) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                     (<span class="fu">sd</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(CP_Support[Gender <span class="sc">==</span> <span class="dv">1</span>]))))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>bar_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mean_diff_data, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(Country, mean_diff_CP_Support), <span class="at">x =</span> mean_diff_CP_Support)) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#8A9A5B"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> mean_diff_CP_Support <span class="sc">-</span> se_diff_CP_Support, </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> mean_diff_CP_Support <span class="sc">+</span> se_diff_CP_Support),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" "</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">" "</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">" "</span> ) <span class="sc">+</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>) ) <span class="sc">+</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="fu">ifelse</span>(<span class="fu">levels</span>(<span class="fu">reorder</span>(mean_diff_data<span class="sc">$</span>Country, mean_diff_data<span class="sc">$</span>mean_diff_CP_Support)) <span class="sc">==</span> <span class="st">"USA"</span>, <span class="st">"red"</span>, <span class="st">"black"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Vectorized input to `element_text()` is not officially supported.
ℹ Results may be unexpected or may change in future versions of ggplot2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"bar_plot.png"</span>, <span class="at">plot =</span> bar_plot, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>aggregated <span class="ot">&lt;-</span> <span class="fu">left_join</span>(result, Clean, <span class="at">by =</span> <span class="st">"Country"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, CTL, diff)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>aggregated <span class="ot">&lt;-</span> <span class="fu">unique</span>(aggregated) <span class="co">#remove duplicates from aggregated</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>new_map <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aggregated, <span class="at">by =</span> <span class="fu">join_by</span>(region <span class="sc">==</span> Country))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>            <span class="co"># "region", by.y = "Country", all.y = TRUE, all.x = TRUE) </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">aggregate</span>(new_map<span class="sc">$</span>diff, <span class="at">by =</span> <span class="fu">list</span>(new_map<span class="sc">$</span>region), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>current <span class="ot">=</span> test <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> x <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>newtest <span class="ot">=</span> <span class="fu">merge</span>(aggregated, current, <span class="at">by.y =</span> <span class="st">"Group.1"</span>, <span class="at">by.x =</span> <span class="st">"Country"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(new_map$region))</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>new_map<span class="sc">|&gt;</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(long, lat)) <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">fill =</span> diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SOCIOL496_files/figure-html/visualization%20map%20view-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated, <span class="fu">aes</span>(<span class="at">x =</span> diff, <span class="at">y =</span> CTL, <span class="at">label =</span> Country)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#8A9A5B"</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" "</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"mean gender difference in support for capital punishment"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cultural Tightness-Looseness Score"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>) )</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"correlation.png"</span>, <span class="at">plot =</span> correlation, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: label
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>cor_coefficient <span class="ot">&lt;-</span> <span class="fu">cor</span>(aggregated<span class="sc">$</span>CTL, aggregated<span class="sc">$</span>diff)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(aggregated<span class="sc">$</span>CTL, aggregated<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  aggregated$CTL and aggregated$diff
t = -1.4349, df = 42, p-value = 0.1587
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.48211122  0.08624394
sample estimates:
       cor 
-0.2161713 </code></pre>
</div>
</div>
</section>
<section id="rescaling-notes-for-comparing-the-two-methods" class="level1">
<h1>rescaling &amp; notes for comparing the two methods</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>CP_Support <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>CP_Support)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>CTL <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>CTL)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Political_Belief <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Political_Belief)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Income <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Income)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>GDP <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>GDP)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Gini <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Gini)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Gender_Index <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Gender_Index)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Pop_Density <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Pop_Density)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Globalization <span class="ot">&lt;-</span> <span class="fu">scale</span>(Clean<span class="sc">$</span>Globalization)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>CTL <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">as.numeric</span>(Clean<span class="sc">$</span>CTL))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>fixed country effect vs MLM?</p>
<p><u>Fixed country effects:</u></p>
<ol type="1">
<li>Treats each country as a separate group or category</li>
<li>Includes a dummy variable for each country</li>
<li>Estimates a separate intercept for each country</li>
<li>Assumes that differences between countries are fixed, non-random</li>
<li>Does not allow for generalizing the findings to a broader population of countries</li>
</ol>
<p><u>Multilevel modeling:</u></p>
<ol type="1">
<li>Explicitly models the nested structure of the data (individuals within countries)</li>
<li>Allows for estimating both individual-level and country-level effects</li>
<li>Treats country-level effects as random, drawn from a distribution of possible values</li>
<li>Allows for generalizing findings to a broader population of countries</li>
<li>Provides estimates of the variance at each level (individual and country)</li>
</ol>
<p>Generally, multilevel modeling is preferred when:</p>
<ol type="1">
<li>The sample of countries is considered a random sample from a larger population of countries, and you want to make inferences about that larger population.</li>
<li>You are interested in decomposing the total variance into individual-level and country-level components.</li>
<li>You anticipate that the relationship between the individual-level independent variable and the dependent variable may vary across countries (varying/random slopes).</li>
</ol>
<p>Fixed country effects might be preferred when:</p>
<ol type="1">
<li>The countries in your sample are not a random sample</li>
<li>You are primarily interested in estimating the average effect of the individual-level independent variable, while controlling for country-level differences</li>
<li>The number of countries is relatively small (e.g., less than 10-15)</li>
</ol>
<p><u>When we have both an individual-level and a country-level independent variable, and we nest observations within countries, <strong>there is a potential issue with conflating the contributions of the two variables</strong></u><strong>.</strong></p>
<ul>
<li><p>In a multilevel model, the country-level random effects (or fixed effects) capture all the unobserved characteristics and influences at the country level that affect the outcome variable. This includes the effect of the country-level independent variable included in the model, as well as any other unmeasured country-level factors.</p></li>
<li><p>So, when nesting observations within countries, we are effectively controlling for all country-level influences, observed and unobserved. This means that the estimate of the effect of our country-level independent variable may be attenuated or even become non-significant, because its effect is being partially or fully absorbed by the country-level random (or fixed) effects.</p></li>
<li><p>Can be addressed by <u>including an interaction between the individual-level and country-level independent variables</u>. This allows the effect of the individual-level variable to vary across countries, and helps separate the contributions of the two variables.</p></li>
</ul>
<p>So, how do I make sense that CTL was a significant separate factor in fixed country effect but not in MLM? -&gt; <em>if CTL varies primarily between countries, then the country fixed/random effects will capture nearly the same source of variation in the outcome.</em></p>
<ol type="1">
<li><p><u>Over-controlling for country differences:</u> As we discussed earlier, the country-level random effects may be absorbing some of the true effect of the country-level predictor, leading to an underestimated effect in the multilevel model. This is an example of cross-level bias.</p></li>
<li><p><u>Confounding country-level variables</u>: The fixed effects model may be confounded by unobserved country-level factors. The multilevel model accounts for this through the random effects, thereby reducing confounding bias and weakening the significance of the country predictor.</p></li>
<li><p><u>Model dependency:</u> The significance can be sensitive to whether <u>other covariates</u> are included in the model. Different sets of controls may change the estimate and significance.</p></li>
</ol>
</section>
<section id="mlm" class="level1">
<h1>MLM</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>Unconditional1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CP_Support <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span>Country), <span class="at">data =</span> Clean_main)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Unconditional1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: CP_Support ~ (1 | Country)
   Data: Clean_main

REML criterion at convergence: 418360.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.9950 -0.8146 -0.2858  0.7532  2.6666 

Random effects:
 Groups   Name        Variance Std.Dev.
 Country  (Intercept) 1.145    1.070   
 Residual             8.590    2.931   
Number of obs: 83818, groups:  Country, 44

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   3.8937     0.1617 43.0000   24.08   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(Unconditional1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 grps   icc
1 Country (Intercept) 0.118
2            Residual 0.882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ICC of 0.117, more than enough to justify teh use of multilevel model </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>model_Gender1<span class="ot">&lt;-</span> <span class="fu">lmer</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">+</span> (<span class="dv">1</span>  <span class="sc">|</span> Country),  </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> Clean_main)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1 means that, the baseline level (support from men) can vary across different countries. It acknowledges that there may be unobserved or unmeasured factors specific to each country that influence capital punishment support. The model accounts for this variability between countries and allows for more accurate estimation of the effect of gender on capital punishment support while controlling for country-level differences.This only finds, on average, how different women are. </span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_Gender1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: CP_Support ~ Gender + (1 | Country)
   Data: Clean_main

REML criterion at convergence: 418048.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0591 -0.7999 -0.2834  0.7364  2.7316 

Random effects:
 Groups   Name        Variance Std.Dev.
 Country  (Intercept) 1.145    1.070   
 Residual             8.557    2.925   
Number of obs: 83818, groups:  Country, 44

Fixed effects:
              Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)  4.089e+00  1.620e-01  4.340e+01   25.23   &lt;2e-16 ***
Gender1     -3.627e-01  2.034e-02  8.378e+04  -17.83   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
        (Intr)
Gender1 -0.068</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model_Gender2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Gender <span class="sc">|</span> Country),  </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> Clean_main)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model_Gender1 allows for the possibility that the relationship between gender and capital punishment support may vary between countries. In other words, this model allows us to see how different women are from men in each country. </span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_Gender2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: CP_Support ~ Gender + (1 + Gender | Country)
   Data: Clean_main

REML criterion at convergence: 417997.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0370 -0.8031 -0.2866  0.7396  2.7283 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 Country  (Intercept) 1.14612  1.0706        
          Gender1     0.05138  0.2267   -0.06
 Residual             8.54628  2.9234        
Number of obs: 83818, groups:  Country, 44

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)  4.07671    0.16220 43.02892  25.134  &lt; 2e-16 ***
Gender1     -0.33670    0.04052 38.80658  -8.309 3.82e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
        (Intr)
Gender1 -0.086</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#if model_Gender2 fits better, if support hypothesis 1</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_Gender1, model_Gender2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: Clean_main
Models:
model_Gender1: CP_Support ~ Gender + (1 | Country)
model_Gender2: CP_Support ~ Gender + (1 + Gender | Country)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
model_Gender1    4 418049 418086 -209020   418041                         
model_Gender2    6 418003 418059 -208995   417991 50.346  2  1.168e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#indeed, H1 is supported</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#refitting model(s) with ML (instead of REML) for likelihood ratio test: Model Comparisons: Likelihood ratio tests can also compare nested multilevel models with different distributions or link functions. For example, you might compare a linear mixed-effects model to a generalized linear mixed-effects model to assess whether a non-linear link function provides a better fit to the data.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">+</span> CTL <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Country),  </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> Clean_main)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">#model_3 assumes that gender and CTL functions separately, and their average associaton is the same across countries. It is not considering any variation in these relationships between different countries</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: CP_Support ~ Gender + CTL + (1 | Country)
   Data: Clean_main

REML criterion at convergence: 418047.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0593 -0.7998 -0.2834  0.7364  2.7317 

Random effects:
 Groups   Name        Variance Std.Dev.
 Country  (Intercept) 1.172    1.083   
 Residual             8.557    2.925   
Number of obs: 83818, groups:  Country, 44

Fixed effects:
              Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)  4.105e+00  1.286e+00  4.202e+01   3.192  0.00268 ** 
Gender1     -3.627e-01  2.034e-02  8.378e+04 -17.831  &lt; 2e-16 ***
CTL         -8.238e-03  6.737e-01  4.202e+01  -0.012  0.99030    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
        (Intr) Gendr1
Gender1 -0.010       
CTL     -0.992  0.001</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>model_4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">*</span> CTL <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Country), <span class="at">data =</span> Clean_main)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#model_4 assumes that the relationship of gender depends on CTL, but still, this effect/association is the same across countries (the relationship between gender and capital punishment support may vary depending on the level of CTL.)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: CP_Support ~ Gender * CTL + (1 | Country)
   Data: Clean_main

REML criterion at convergence: 418043.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0453 -0.7997 -0.2910  0.7334  2.7297 

Random effects:
 Groups   Name        Variance Std.Dev.
 Country  (Intercept) 1.173    1.083   
 Residual             8.557    2.925   
Number of obs: 83818, groups:  Country, 44

Fixed effects:
              Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)  4.336e+00  1.289e+00  4.240e+01   3.363  0.00164 ** 
Gender1     -7.981e-01  1.638e-01  8.378e+04  -4.872  1.1e-06 ***
CTL         -1.308e-01  6.755e-01  4.240e+01  -0.194  0.84744    
Gender1:CTL  2.311e-01  8.626e-02  8.378e+04   2.679  0.00739 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) Gendr1 CTL   
Gender1     -0.068              
CTL         -0.992  0.067       
Gender1:CTL  0.067 -0.992 -0.068</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for some reasons it is not running when it is cros-s-level interaction: Cross-Level Interactions: LRTs can test the significance of cross-level interactions in multilevel models. For instance, you might compare a model with no cross-level interactions to a model that includes cross-level interactions between a higher-level variable and lower-level predictors.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model_4 is considering whether the impact of gender on capital punishment support changes depending on whether a country has a tight or loose culture.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_3, model_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: Clean_main
Models:
model_3: CP_Support ~ Gender + CTL + (1 | Country)
model_4: CP_Support ~ Gender * CTL + (1 | Country)
        npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)   
model_3    5 418051 418098 -209020   418041                        
model_4    6 418046 418102 -209017   418034 7.1753  1   0.007391 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model 4 did better</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_3, model_Gender1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: Clean_main
Models:
model_Gender1: CP_Support ~ Gender + (1 | Country)
model_3: CP_Support ~ Gender + CTL + (1 | Country)
              npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)
model_Gender1    4 418049 418086 -209020   418041                    
model_3          5 418051 418098 -209020   418041 2e-04  1       0.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not significant </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_4, model_Gender1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: Clean_main
Models:
model_Gender1: CP_Support ~ Gender + (1 | Country)
model_4: CP_Support ~ Gender * CTL + (1 | Country)
              npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
model_Gender1    4 418049 418086 -209020   418041                       
model_4          6 418046 418102 -209017   418034 7.1755  2    0.02766 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model 4 better</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linearity, homogeneity of variance, normal distribution of residuals (source:https://ademos.people.uic.edu/Chapter18.html)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>model_resid <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_3)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(model_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SOCIOL496_files/figure-html/assumption%20tests-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(model_resid)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(model_resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SOCIOL496_files/figure-html/assumption%20tests-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_3)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predicted, model_resid, <span class="at">main =</span> <span class="st">"Residuals vs. Fitted"</span>, </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SOCIOL496_files/figure-html/assumption%20tests-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Confirmatory analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountry_gender1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">+</span> Country , <span class="at">data =</span> Clean_main)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountry_gender1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender + Country, data = Clean_main)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.0383 -2.3374 -0.8273  2.1548  7.9988 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            3.571323   0.094900  37.632  &lt; 2e-16 ***
Gender1               -0.362677   0.020340 -17.831  &lt; 2e-16 ***
CountryArmenia        -1.031142   0.109881  -9.384  &lt; 2e-16 ***
CountryAustralia       1.108068   0.117142   9.459  &lt; 2e-16 ***
CountryAustria        -1.063890   0.119517  -8.902  &lt; 2e-16 ***
CountryBosnia         -0.073014   0.118511  -0.616   0.5378    
CountryBrazil          0.755361   0.118314   6.384 1.73e-10 ***
CountryCanada          1.444725   0.105001  13.759  &lt; 2e-16 ***
CountryChile           0.870736   0.133071   6.543 6.05e-11 ***
CountryChina           2.145859   0.108288  19.816  &lt; 2e-16 ***
CountryColombia        0.572515   0.120520   4.750 2.03e-06 ***
CountryCzech Republic  1.496170   0.109313  13.687  &lt; 2e-16 ***
CountryEcuador         0.273968   0.127023   2.157   0.0310 *  
CountryEstonia         1.044683   0.125857   8.301  &lt; 2e-16 ***
CountryFinland        -0.545368   0.127266  -4.285 1.83e-05 ***
CountryGermany        -0.796300   0.106072  -7.507 6.10e-14 ***
CountryGreece         -0.948913   0.128017  -7.412 1.25e-13 ***
CountryHungary         1.058074   0.121283   8.724  &lt; 2e-16 ***
CountryIceland        -1.207495   0.119544 -10.101  &lt; 2e-16 ***
CountryIndonesia       0.009435   0.107704   0.088   0.9302    
CountryIran            3.466987   0.121086  28.632  &lt; 2e-16 ***
CountryItaly          -0.664097   0.112831  -5.886 3.98e-09 ***
CountryJapan           3.429422   0.126248  27.164  &lt; 2e-16 ***
CountryKazakhstan      0.114555   0.127866   0.896   0.3703    
CountryKenya           0.249267   0.126573   1.969   0.0489 *  
CountryLatvia          0.128760   0.126599   1.017   0.3091    
CountryMalaysia        1.184896   0.124148   9.544  &lt; 2e-16 ***
CountryMexico          0.246806   0.117872   2.094   0.0363 *  
CountryNetherlands     0.022869   0.104479   0.219   0.8267    
CountryNigeria        -0.773133   0.126134  -6.129 8.86e-10 ***
CountryPeru            0.563342   0.122996   4.580 4.65e-06 ***
CountryPoland          0.672847   0.124677   5.397 6.81e-08 ***
CountryPortugal       -0.572507   0.127201  -4.501 6.78e-06 ***
CountryRussia          1.290856   0.107068  12.056  &lt; 2e-16 ***
CountrySingapore       1.403237   0.114890  12.214  &lt; 2e-16 ***
CountrySlovakia        0.273863   0.111366   2.459   0.0139 *  
CountrySouth Korea     0.954289   0.125573   7.600 3.00e-14 ***
CountrySpain           0.255964   0.127317   2.010   0.0444 *  
CountrySweden         -0.774247   0.127339  -6.080 1.21e-09 ***
CountryThailand        1.120418   0.121198   9.245  &lt; 2e-16 ***
CountryTurkey         -0.097250   0.111940  -0.869   0.3850    
CountryUkraine         1.115418   0.110954  10.053  &lt; 2e-16 ***
CountryUnited Kingdom  1.133331   0.104348  10.861  &lt; 2e-16 ***
CountryUSA             2.108172   0.110595  19.062  &lt; 2e-16 ***
CountryVietnam         0.799138   0.126596   6.313 2.76e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.925 on 83773 degrees of freedom
Multiple R-squared:  0.1156,    Adjusted R-squared:  0.1151 
F-statistic: 248.9 on 44 and 83773 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gender remains a significant predictor </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountry_gender2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">*</span> Country, <span class="at">data =</span> Clean_main)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountry_gender2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender * Country, data = Clean_main)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.9763 -2.3527 -0.8138  2.1862  7.9792 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    3.566810   0.135714  26.282  &lt; 2e-16 ***
Gender1                       -0.353959   0.188624  -1.877  0.06059 .  
CountryArmenia                -0.986716   0.162846  -6.059 1.37e-09 ***
CountryAustralia               1.209694   0.175106   6.908 4.94e-12 ***
CountryAustria                -1.164033   0.174034  -6.689 2.27e-11 ***
CountryBosnia                 -0.028136   0.173846  -0.162  0.87143    
CountryBrazil                  0.914817   0.172144   5.314 1.07e-07 ***
CountryCanada                  1.595404   0.150229  10.620  &lt; 2e-16 ***
CountryChile                   0.595177   0.192032   3.099  0.00194 ** 
CountryChina                   2.100101   0.157125  13.366  &lt; 2e-16 ***
CountryColombia                0.400295   0.172230   2.324  0.02012 *  
CountryCzech Republic          1.464152   0.159906   9.156  &lt; 2e-16 ***
CountryEcuador                 0.186736   0.183224   1.019  0.30813    
CountryEstonia                 1.469749   0.191825   7.662 1.85e-14 ***
CountryFinland                -0.235241   0.183005  -1.285  0.19864    
CountryGermany                -0.830784   0.152144  -5.461 4.76e-08 ***
CountryGreece                 -0.917816   0.184504  -4.974 6.55e-07 ***
CountryHungary                 1.055447   0.178363   5.917 3.28e-09 ***
CountryIceland                -1.223916   0.171932  -7.119 1.10e-12 ***
CountryIndonesia               0.172533   0.156174   1.105  0.26927    
CountryIran                    3.354449   0.172144  19.486  &lt; 2e-16 ***
CountryItaly                  -0.753023   0.161460  -4.664 3.11e-06 ***
CountryJapan                   3.409467   0.184427  18.487  &lt; 2e-16 ***
CountryKazakhstan              0.092013   0.187551   0.491  0.62371    
CountryKenya                   0.007173   0.179762   0.040  0.96817    
CountryLatvia                 -0.102188   0.196403  -0.520  0.60286    
CountryMalaysia                1.124209   0.177274   6.342 2.28e-10 ***
CountryMexico                  0.200902   0.168357   1.193  0.23275    
CountryNetherlands             0.126609   0.150594   0.841  0.40050    
CountryNigeria                -0.757210   0.179142  -4.227 2.37e-05 ***
CountryPeru                    0.270600   0.175256   1.544  0.12259    
CountryPoland                  0.920627   0.180924   5.088 3.62e-07 ***
CountryPortugal               -0.585405   0.189936  -3.082  0.00206 ** 
CountryRussia                  1.476139   0.156639   9.424  &lt; 2e-16 ***
CountrySingapore               1.372121   0.166547   8.239  &lt; 2e-16 ***
CountrySlovakia                0.279643   0.163473   1.711  0.08715 .  
CountrySouth Korea             0.915891   0.180271   5.081 3.77e-07 ***
CountrySpain                   0.134142   0.186270   0.720  0.47144    
CountrySweden                 -0.600558   0.183297  -3.276  0.00105 ** 
CountryThailand                0.897062   0.175408   5.114 3.16e-07 ***
CountryTurkey                 -0.211536   0.160094  -1.321  0.18640    
CountryUkraine                 1.074873   0.164902   6.518 7.15e-11 ***
CountryUnited Kingdom          1.155650   0.151619   7.622 2.52e-14 ***
CountryUSA                     2.166475   0.156937  13.805  &lt; 2e-16 ***
CountryVietnam                 0.548786   0.184660   2.972  0.00296 ** 
Gender1:CountryArmenia        -0.074307   0.221112  -0.336  0.73683    
Gender1:CountryAustralia      -0.168828   0.236147  -0.715  0.47466    
Gender1:CountryAustria         0.182748   0.239362   0.763  0.44518    
Gender1:CountryBosnia         -0.080237   0.237685  -0.338  0.73568    
Gender1:CountryBrazil         -0.292696   0.236927  -1.235  0.21669    
Gender1:CountryCanada         -0.308511   0.209981  -1.469  0.14177    
Gender1:CountryChile           0.526618   0.266196   1.978  0.04790 *  
Gender1:CountryChina           0.082831   0.216789   0.382  0.70240    
Gender1:CountryColombia        0.344748   0.240975   1.431  0.15254    
Gender1:CountryCzech Republic  0.054962   0.219193   0.251  0.80201    
Gender1:CountryEcuador         0.166756   0.254087   0.656  0.51164    
Gender1:CountryEstonia        -0.683902   0.255119  -2.681  0.00735 ** 
Gender1:CountryFinland        -0.600751   0.254514  -2.360  0.01826 *  
Gender1:CountryGermany         0.068891   0.212112   0.325  0.74534    
Gender1:CountryGreece         -0.059741   0.256058  -0.233  0.81552    
Gender1:CountryHungary         0.003884   0.243354   0.016  0.98727    
Gender1:CountryIceland         0.031822   0.239073   0.133  0.89411    
Gender1:CountryIndonesia      -0.298252   0.215598  -1.383  0.16656    
Gender1:CountryIran            0.231868   0.242139   0.958  0.33828    
Gender1:CountryItaly           0.178413   0.225614   0.791  0.42907    
Gender1:CountryJapan           0.035852   0.252956   0.142  0.88729    
Gender1:CountryKazakhstan      0.039963   0.256381   0.156  0.87613    
Gender1:CountryKenya           0.496699   0.253099   1.962  0.04971 *  
Gender1:CountryLatvia          0.355231   0.258329   1.375  0.16910    
Gender1:CountryMalaysia        0.121781   0.248223   0.491  0.62370    
Gender1:CountryMexico          0.092710   0.235685   0.393  0.69405    
Gender1:CountryNetherlands    -0.197245   0.208982  -0.944  0.34526    
Gender1:CountryNigeria        -0.032112   0.252222  -0.127  0.89869    
Gender1:CountryPeru            0.593245   0.245928   2.412  0.01586 *  
Gender1:CountryPoland         -0.462464   0.249559  -1.853  0.06387 .  
Gender1:CountryPortugal        0.020890   0.256133   0.082  0.93500    
Gender1:CountryRussia         -0.319863   0.214729  -1.490  0.13633    
Gender1:CountrySingapore       0.057418   0.229953   0.250  0.80282    
Gender1:CountrySlovakia       -0.010908   0.223465  -0.049  0.96107    
Gender1:CountrySouth Korea     0.075019   0.251104   0.299  0.76513    
Gender1:CountrySpain           0.220448   0.255161   0.864  0.38761    
Gender1:CountrySweden         -0.335066   0.254678  -1.316  0.18830    
Gender1:CountryThailand        0.420022   0.242519   1.732  0.08329 .  
Gender1:CountryTurkey          0.230507   0.223834   1.030  0.30310    
Gender1:CountryUkraine         0.064948   0.223438   0.291  0.77130    
Gender1:CountryUnited Kingdom -0.040254   0.208982  -0.193  0.84726    
Gender1:CountryUSA            -0.124704   0.221295  -0.564  0.57308    
Gender1:CountryVietnam         0.458210   0.253589   1.807  0.07078 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.923 on 83730 degrees of freedom
Multiple R-squared:  0.1172,    Adjusted R-squared:  0.1163 
F-statistic: 127.8 on 87 and 83730 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_linear_fixedcountry_gender1, model_linear_fixedcountry_gender2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: CP_Support ~ Gender + Country
Model 2: CP_Support ~ Gender * Country
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1  83773 716862                                  
2  83730 715564 43    1297.8 3.5317 4.757e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountry <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">+</span> CTL <span class="sc">+</span> Country , <span class="at">data =</span> Clean_main)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender + CTL + Country, data = Clean_main)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.0383 -2.3374 -0.8273  2.1548  7.9988 

Coefficients: (1 not defined because of singularities)
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            1.59251    0.38897   4.094 4.24e-05 ***
Gender1               -0.36268    0.02034 -17.831  &lt; 2e-16 ***
CTL                    1.26847    0.20095   6.313 2.76e-10 ***
CountryArmenia        -1.67806    0.09040 -18.562  &lt; 2e-16 ***
CountryAustralia       0.67679    0.09374   7.220 5.26e-13 ***
CountryAustria        -1.74887    0.10397 -16.821  &lt; 2e-16 ***
CountryBosnia         -0.16181    0.11075  -1.461 0.144022    
CountryBrazil          0.59046    0.10493   5.627 1.84e-08 ***
CountryCanada          1.10224    0.07965  13.838  &lt; 2e-16 ***
CountryChile           0.71852    0.12207   5.886 3.97e-09 ***
CountryChina           1.52431    0.08709  17.504  &lt; 2e-16 ***
CountryColombia        0.67399    0.13055   5.163 2.44e-07 ***
CountryCzech Republic  1.40738    0.10085  13.955  &lt; 2e-16 ***
CountryEcuador        -0.05583    0.10734  -0.520 0.602954    
CountryEstonia         0.96857    0.11954   8.102 5.47e-16 ***
CountryFinland        -0.78638    0.11086  -7.094 1.32e-12 ***
CountryGermany        -1.39248    0.08306 -16.764  &lt; 2e-16 ***
CountryGreece         -1.13918    0.11429  -9.968  &lt; 2e-16 ***
CountryHungary         1.18492    0.13393   8.847  &lt; 2e-16 ***
CountryIceland        -1.68951    0.09691 -17.435  &lt; 2e-16 ***
CountryIndonesia      -0.95460    0.11602  -8.228  &lt; 2e-16 ***
CountryIran            2.59174    0.12001  21.596  &lt; 2e-16 ***
CountryItaly          -1.05732    0.08864 -11.928  &lt; 2e-16 ***
CountryJapan           2.75713    0.11097  24.846  &lt; 2e-16 ***
CountryKazakhstan     -0.54505    0.11218  -4.859 1.18e-06 ***
CountryKenya          -0.76551    0.13883  -5.514 3.52e-08 ***
CountryLatvia         -0.27715    0.10547  -2.628 0.008597 ** 
CountryMalaysia        0.47455    0.11073   4.285 1.83e-05 ***
CountryMexico          0.08190    0.10443   0.784 0.432855    
CountryNetherlands    -0.01518    0.10052  -0.151 0.879932    
CountryNigeria        -1.66106    0.12621 -13.161  &lt; 2e-16 ***
CountryPeru            0.38576    0.10939   3.526 0.000421 ***
CountryPoland          0.49526    0.11128   4.451 8.57e-06 ***
CountryPortugal       -1.13063    0.10757 -10.511  &lt; 2e-16 ***
CountryRussia          1.15132    0.09405  12.241  &lt; 2e-16 ***
CountrySingapore       0.54068    0.11255   4.804 1.56e-06 ***
CountrySlovakia        0.08359    0.09526   0.878 0.380217    
CountrySouth Korea     0.28200    0.11020   2.559 0.010502 *  
CountrySpain           0.06569    0.11350   0.579 0.562725    
CountrySweden         -1.58607    0.12117 -13.090  &lt; 2e-16 ***
CountryThailand        0.39739    0.10822   3.672 0.000241 ***
CountryTurkey         -0.87102    0.10164  -8.570  &lt; 2e-16 ***
CountryUkraine         0.88709    0.09239   9.602  &lt; 2e-16 ***
CountryUnited Kingdom  0.86695    0.08209  10.561  &lt; 2e-16 ***
CountryUSA             1.77837    0.08729  20.373  &lt; 2e-16 ***
CountryVietnam              NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.925 on 83773 degrees of freedom
Multiple R-squared:  0.1156,    Adjusted R-squared:  0.1151 
F-statistic: 248.9 on 44 and 83773 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CTL is now prediciting more support, but it is NOT part of our hypothesis </span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#1 not defined because of singularities because </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The error about “singularities” in the fixed effects model - <u>this often occurs when <strong>predictors are collinear</strong></u></p>
<p>it is quite possible that the CTL variable, as a measure of cultural tightness-looseness at the country level, <u><strong>is primarily just capturing inherent differences between countries</strong></u>. There are a few reasons why this may be the case:</p>
<ul>
<li><p>Tightness-looseness is conceptualized as a <u>cultural characteristic</u> that varies between societies and countries. So the CTL measure was designed specifically to capture country/society-level differences in this cultural dimension.</p></li>
<li><p>Countries likely differ on a whole host of historical, contextual, and compositional factors that shape their level of cultural tightness-looseness. The CTL variable summarizes all of these complex country differences into a single cultural dimension.</p></li>
<li><p>If tightness-looseness is fairly stable within countries over time, then CTL won’t show much variation except between countries. This could make it <em>highly collinear</em> with country fixed effects in a regression model.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountry2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">*</span> CTL <span class="sc">+</span> Country , <span class="at">data =</span> Clean)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountry2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender * CTL + Country, data = Clean)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9284 -0.7515 -0.2732  0.6904  2.5701 

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            0.009916   0.020612   0.481 0.630470    
Gender1               -0.116893   0.006541 -17.870  &lt; 2e-16 ***
CTL                    0.086545   0.015572   5.558 2.74e-08 ***
CountryArmenia        -0.540341   0.029071 -18.587  &lt; 2e-16 ***
CountryAustralia       0.217872   0.030143   7.228 4.95e-13 ***
CountryAustria        -0.562286   0.033431 -16.819  &lt; 2e-16 ***
CountryBosnia         -0.051076   0.035614  -1.434 0.151535    
CountryBrazil          0.190407   0.033740   5.643 1.67e-08 ***
CountryCanada          0.354593   0.025613  13.844  &lt; 2e-16 ***
CountryChile           0.231255   0.039251   5.892 3.84e-09 ***
CountryChina           0.490272   0.028002  17.508  &lt; 2e-16 ***
CountryColombia        0.216118   0.041978   5.148 2.63e-07 ***
CountryCzech Republic  0.453692   0.032431  13.990  &lt; 2e-16 ***
CountryEcuador        -0.017665   0.034516  -0.512 0.608797    
CountryEstonia         0.313589   0.038448   8.156 3.50e-16 ***
CountryFinland        -0.252692   0.035646  -7.089 1.36e-12 ***
CountryGermany        -0.447128   0.026710 -16.740  &lt; 2e-16 ***
CountryGreece         -0.366124   0.036749  -9.963  &lt; 2e-16 ***
CountryHungary         0.382470   0.043069   8.880  &lt; 2e-16 ***
CountryIceland        -0.542894   0.031161 -17.422  &lt; 2e-16 ***
CountryIndonesia      -0.307168   0.037307  -8.234  &lt; 2e-16 ***
CountryIran            0.834960   0.038594  21.634  &lt; 2e-16 ***
CountryItaly          -0.339701   0.028504 -11.918  &lt; 2e-16 ***
CountryJapan           0.886653   0.035682  24.849  &lt; 2e-16 ***
CountryKazakhstan     -0.175294   0.036070  -4.860 1.18e-06 ***
CountryKenya          -0.244293   0.044646  -5.472 4.47e-08 ***
CountryLatvia         -0.088755   0.033915  -2.617 0.008872 ** 
CountryMalaysia        0.153485   0.035609   4.310 1.63e-05 ***
CountryMexico          0.026172   0.033579   0.779 0.435736    
CountryNetherlands    -0.004663   0.032324  -0.144 0.885304    
CountryNigeria        -0.532587   0.040587 -13.122  &lt; 2e-16 ***
CountryPeru            0.123860   0.035174   3.521 0.000430 ***
CountryPoland          0.159653   0.035781   4.462 8.13e-06 ***
CountryPortugal       -0.363730   0.034589 -10.516  &lt; 2e-16 ***
CountryRussia          0.371346   0.030245  12.278  &lt; 2e-16 ***
CountrySingapore       0.173996   0.036192   4.808 1.53e-06 ***
CountrySlovakia        0.027821   0.030633   0.908 0.363775    
CountrySouth Korea     0.091300   0.035437   2.576 0.009984 ** 
CountrySpain           0.021713   0.036496   0.595 0.551884    
CountrySweden         -0.509388   0.038963 -13.074  &lt; 2e-16 ***
CountryThailand        0.128113   0.034799   3.682 0.000232 ***
CountryTurkey         -0.279019   0.032685  -8.537  &lt; 2e-16 ***
CountryUkraine         0.286449   0.029711   9.641  &lt; 2e-16 ***
CountryUnited Kingdom  0.279393   0.026397  10.584  &lt; 2e-16 ***
CountryUSA             0.571865   0.028068  20.374  &lt; 2e-16 ***
CountryVietnam               NA         NA      NA       NA    
Gender1:CTL            0.017494   0.006517   2.684 0.007271 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9406 on 83772 degrees of freedom
  (3124 observations deleted due to missingness)
Multiple R-squared:  0.1157,    Adjusted R-squared:  0.1152 
F-statistic: 243.5 on 45 and 83772 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CTL effect: 0.086545   0.015572   5.558 2.74e-08 ***</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># significant interaction effect: 0.017494   0.006517   2.684 0.007271, this means that the effect of being </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_linear_fixedcountry, model_linear_fixedcountry2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: CP_Support ~ Gender + CTL + Country
Model 2: CP_Support ~ Gender * CTL + Country
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1  83773 716862                                  
2  83772  74119  1    642742 726448 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction model is more predictive than addition model (explains more RSS? Residual Sum of Squares, which is the sum of the squared differences between the observed values and the predicted values (i.e., residuals) from the regression model. It represents the unexplained variability in the data after accounting for the effects of the predictors in the model.)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#interaction visualization</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#package reference: https://cran.r-project.org/web/packages/sjPlot/vignettes/plot_interactions.html (the one used here)</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co">#additional reference: https://interactions.jacob-long.com/reference/interact_plot.html</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#additional reference2: https://ademos.people.uic.edu/Chapter13.html</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>Clean<span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(Clean<span class="sc">$</span>Gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> CTL <span class="sc">*</span> Gender <span class="sc">+</span> Country , <span class="at">data =</span> Clean)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set_theme</span>(<span class="at">base =</span> <span class="fu">theme_classic</span>())</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>interaction <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(model_interaction, <span class="at">type =</span> <span class="st">"int"</span>, </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Interaction"</span>, <span class="at">axis.title =</span> <span class="st">"Capital Punishment Support"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(model, newdata = data_grid, type = "response", se.fit =
se, : prediction from rank-deficient fit; attr(*, "non-estim") has doubtful
cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># an explanation of "int" type: A shortcut for marginal effects plots, where interaction terms are automatically detected and used as terms-argument. Furthermore, if the moderator variable (the second - and third - term in an interaction) is continuous, type = "int" automatically chooses useful values based on the mdrt.values-argument, which are passed to terms. Then, ggpredict is called. type = "int" plots the interaction term that appears first in the formula along the x-axis, while the second (and possibly third) variable in an interaction is used as grouping factor(s) (moderating variable). Use type = "pred" or type = "eff" and specify a certain order in the terms-argument to indicate which variable(s) should be used as moderator. See also this package-vignette</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#theme aesthetics: https://strengejacke.github.io/sjPlot/articles/custplot.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-analysis" class="level1">
<h1>Exploratory Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(Clean[<span class="fu">c</span>(<span class="st">"CTL"</span>, <span class="st">"GDP"</span>, <span class="st">"Gini"</span>, <span class="st">"Gender_Index"</span>, <span class="st">"Pop_Density"</span>)])</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     CTL         GDP       Gini Gender_Index Pop_Density
CTL           1.00000000 -0.09205168  0.1361384  -0.28434801  0.23487723
GDP          -0.09205168  1.00000000 -0.2811769   0.58725335  0.33731219
Gini          0.13613841 -0.28117694  1.0000000  -0.40395785  0.21586345
Gender_Index -0.28434801  0.58725335 -0.4039579   1.00000000 -0.02964851
Pop_Density   0.23487723  0.33731219  0.2158634  -0.02964851  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>model_VIF <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> CTL <span class="sc">+</span> GDP <span class="sc">+</span> Gini <span class="sc">+</span> Gender_Index <span class="sc">+</span> Pop_Density, <span class="at">data =</span> Clean_main)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model_VIF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         CTL          GDP         Gini Gender_Index  Pop_Density 
    1.157142     1.969930     1.308663     1.873609     1.418735 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Clean_complete <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Clean_main)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountryInd <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">*</span> CTL <span class="sc">+</span> Education <span class="sc">+</span> Political_Belief <span class="sc">+</span> Income <span class="sc">+</span> Religion <span class="sc">+</span> Country , <span class="at">data =</span> Clean_complete)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountryInd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender * CTL + Education + Political_Belief + 
    Income + Religion + Country, data = Clean_complete)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.6105 -2.2482 -0.8161  1.9750  8.4833 

Coefficients: (1 not defined because of singularities)
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -10.033175   0.816487 -12.288  &lt; 2e-16 ***
Gender1                -0.490378   0.185720  -2.640 0.008283 ** 
CTL                     8.499689   0.462223  18.389  &lt; 2e-16 ***
Education              -0.088381   0.017439  -5.068 4.03e-07 ***
Political_Belief        0.119863   0.005193  23.079  &lt; 2e-16 ***
Income                 -0.002694   0.005344  -0.504 0.614110    
ReligionChristian      -0.429056   0.029431 -14.578  &lt; 2e-16 ***
ReligionMuslim         -0.454547   0.064993  -6.994 2.70e-12 ***
ReligionBuddhist       -0.097716   0.090572  -1.079 0.280647    
ReligionOther          -0.453245   0.076578  -5.919 3.26e-09 ***
CountryArmenia         -5.205548   0.165389 -31.474  &lt; 2e-16 ***
CountryAustralia       -1.778367   0.108941 -16.324  &lt; 2e-16 ***
CountryAustria         -5.476255   0.183949 -29.771  &lt; 2e-16 ***
CountryBosnia          -0.316081   0.117468  -2.691 0.007131 ** 
CountryBrazil          -0.156819   0.107062  -1.465 0.142994    
CountryCanada          -0.761915   0.075133 -10.141  &lt; 2e-16 ***
CountryChile            0.182485   0.127263   1.434 0.151600    
CountryColombia         1.228370   0.155728   7.888 3.12e-15 ***
CountryCzech Republic   0.820912   0.099024   8.290  &lt; 2e-16 ***
CountryEcuador         -1.915924   0.105204 -18.211  &lt; 2e-16 ***
CountryEstonia          0.408158   0.129877   3.143 0.001675 ** 
CountryFinland         -2.040957   0.101137 -20.180  &lt; 2e-16 ***
CountryGermany         -4.688386   0.144083 -32.539  &lt; 2e-16 ***
CountryGreece          -2.071120   0.108987 -19.003  &lt; 2e-16 ***
CountryHungary          2.043672   0.171441  11.921  &lt; 2e-16 ***
CountryIceland         -4.254356   0.124217 -34.249  &lt; 2e-16 ***
CountryIndonesia       -6.380286   0.274614 -23.234  &lt; 2e-16 ***
CountryItaly           -3.156142   0.109806 -28.743  &lt; 2e-16 ***
CountryJapan           -1.225576   0.190303  -6.440 1.20e-10 ***
CountryKenya           -6.343062   0.295240 -21.484  &lt; 2e-16 ***
CountryLatvia          -2.633218   0.123932 -21.247  &lt; 2e-16 ***
CountryMalaysia        -3.491700   0.195686 -17.843  &lt; 2e-16 ***
CountryMexico          -0.684655   0.095521  -7.168 7.72e-13 ***
CountryNetherlands     -0.364446   0.105439  -3.456 0.000548 ***
CountryNigeria         -6.579765   0.253691 -25.936  &lt; 2e-16 ***
CountryPeru            -0.475416   0.101975  -4.662 3.14e-06 ***
CountryPoland          -0.366433   0.114182  -3.209 0.001332 ** 
CountryRussia           0.480181   0.091061   5.273 1.35e-07 ***
CountrySingapore       -4.226959   0.238373 -17.733  &lt; 2e-16 ***
CountrySlovakia        -1.038844   0.086724 -11.979  &lt; 2e-16 ***
CountrySouth Korea     -3.608268   0.179551 -20.096  &lt; 2e-16 ***
CountrySpain           -1.050709   0.120197  -8.742  &lt; 2e-16 ***
CountrySweden          -6.147067   0.226845 -27.098  &lt; 2e-16 ***
CountryThailand        -3.962877   0.216531 -18.302  &lt; 2e-16 ***
CountryTurkey          -5.203133   0.215441 -24.151  &lt; 2e-16 ***
CountryUkraine         -0.231157   0.091586  -2.524 0.011608 *  
CountryUnited Kingdom  -0.717684   0.071199 -10.080  &lt; 2e-16 ***
CountryUSA                    NA         NA      NA       NA    
Gender1:CTL             0.072876   0.098357   0.741 0.458737    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.852 on 60238 degrees of freedom
Multiple R-squared:  0.1171,    Adjusted R-squared:  0.1164 
F-statistic: 169.9 on 47 and 60238 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>model_linear_fixedcountryAll <span class="ot">&lt;-</span> <span class="fu">lm</span>(CP_Support <span class="sc">~</span> Gender <span class="sc">*</span> CTL <span class="sc">+</span> Education <span class="sc">+</span> Political_Belief <span class="sc">+</span> Income <span class="sc">+</span> Religion <span class="sc">+</span> Gender_Index <span class="sc">+</span> GDP <span class="sc">+</span> Gini <span class="sc">+</span> Pop_Density <span class="sc">+</span> Globalization <span class="sc">+</span> Country , <span class="at">data =</span> Clean_complete)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linear_fixedcountryAll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CP_Support ~ Gender * CTL + Education + Political_Belief + 
    Income + Religion + Gender_Index + GDP + Gini + Pop_Density + 
    Globalization + Country, data = Clean_complete)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.6105 -2.2482 -0.8161  1.9750  8.4833 

Coefficients: (6 not defined because of singularities)
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            4.602e+00  1.886e+00   2.440 0.014699 *  
Gender1               -4.904e-01  1.857e-01  -2.640 0.008283 ** 
CTL                   -5.622e-01  2.473e-01  -2.273 0.023017 *  
Education             -8.838e-02  1.744e-02  -5.068 4.03e-07 ***
Political_Belief       1.199e-01  5.193e-03  23.079  &lt; 2e-16 ***
Income                -2.694e-03  5.344e-03  -0.504 0.614110    
ReligionChristian     -4.291e-01  2.943e-02 -14.578  &lt; 2e-16 ***
ReligionMuslim        -4.545e-01  6.499e-02  -6.994 2.70e-12 ***
ReligionBuddhist      -9.772e-02  9.057e-02  -1.079 0.280647    
ReligionOther         -4.532e-01  7.658e-02  -5.919 3.26e-09 ***
Gender_Index           2.632e+00  1.852e+00   1.421 0.155243    
GDP                   -3.564e-05  5.554e-06  -6.417 1.40e-10 ***
Gini                  -5.041e-02  9.394e-03  -5.367 8.05e-08 ***
Pop_Density            5.923e-03  4.962e-04  11.936  &lt; 2e-16 ***
Globalization          3.885e-04  2.402e-05  16.178  &lt; 2e-16 ***
CountryArmenia        -2.164e+00  1.258e-01 -17.201  &lt; 2e-16 ***
CountryAustralia       2.478e+00  2.718e-01   9.116  &lt; 2e-16 ***
CountryAustria        -3.910e-01  2.446e-01  -1.599 0.109893    
CountryBosnia         -5.694e-01  1.098e-01  -5.185 2.16e-07 ***
CountryBrazil          1.587e+00  1.745e-01   9.096  &lt; 2e-16 ***
CountryCanada          2.299e+00  1.504e-01  15.282  &lt; 2e-16 ***
CountryChile           1.532e+00  1.506e-01  10.176  &lt; 2e-16 ***
CountryColombia        5.412e-01  1.806e-01   2.997 0.002727 ** 
CountryCzech Republic  2.725e-01  1.842e-01   1.480 0.138935    
CountryEcuador         1.070e-01  1.641e-01   0.652 0.514428    
CountryEstonia         6.008e-01  1.573e-01   3.819 0.000134 ***
CountryFinland        -2.516e-01  1.285e-01  -1.958 0.050181 .  
CountryGermany        -1.489e+00  7.591e-02 -19.619  &lt; 2e-16 ***
CountryGreece         -1.113e+00  1.532e-01  -7.266 3.74e-13 ***
CountryHungary         2.899e-01  2.147e-01   1.351 0.176767    
CountryIceland         2.376e-01  1.682e-01   1.413 0.157722    
CountryIndonesia      -5.586e-01  1.779e-01  -3.140 0.001691 ** 
CountryItaly          -1.022e+00  1.242e-01  -8.228  &lt; 2e-16 ***
CountryJapan           2.284e+00  1.830e-01  12.477  &lt; 2e-16 ***
CountryKenya          -8.532e-02  1.790e-01  -0.477 0.633560    
CountryLatvia         -1.760e-02  1.423e-01  -0.124 0.901564    
CountryMalaysia        1.083e+00  1.006e-01  10.760  &lt; 2e-16 ***
CountryMexico          4.386e-01  1.347e-01   3.256 0.001131 ** 
CountryNetherlands    -2.893e+00  1.491e-01 -19.400  &lt; 2e-16 ***
CountryNigeria        -1.863e+00  1.448e-01 -12.872  &lt; 2e-16 ***
CountryPeru            6.215e-01  1.350e-01   4.605 4.14e-06 ***
CountryPoland         -2.960e-01  1.115e-01  -2.655 0.007943 ** 
CountryRussia          1.139e+00  1.101e-01  10.351  &lt; 2e-16 ***
CountrySingapore      -4.261e+01  3.736e+00 -11.403  &lt; 2e-16 ***
CountrySlovakia       -5.020e-01  1.919e-01  -2.615 0.008913 ** 
CountrySouth Korea    -1.651e+00  1.839e-01  -8.976  &lt; 2e-16 ***
CountrySpain          -2.649e-01  1.202e-01  -2.205 0.027478 *  
CountrySweden                 NA         NA      NA       NA    
CountryThailand               NA         NA      NA       NA    
CountryTurkey                 NA         NA      NA       NA    
CountryUkraine                NA         NA      NA       NA    
CountryUnited Kingdom         NA         NA      NA       NA    
CountryUSA                    NA         NA      NA       NA    
Gender1:CTL            7.288e-02  9.836e-02   0.741 0.458737    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.852 on 60238 degrees of freedom
Multiple R-squared:  0.1171,    Adjusted R-squared:  0.1164 
F-statistic: 169.9 on 47 and 60238 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#interaction no longer signficiant after considering individual level ones, but did after controlling country-level ones </span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gender remained significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>